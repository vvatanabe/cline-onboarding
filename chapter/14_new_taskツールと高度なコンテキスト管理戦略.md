---
marp: true
theme: default
paginate: true
header: "Cline 入門"
footer: "Nulab Inc. 2025"
---

# new_taskツールと高度なコンテキスト管理戦略

Clineは長時間・大規模タスクに対応するため、  
**`new_task` ツール**と**文脈保持機能**を搭載しています。

---

## new_taskツールとは？

🧰 現在のタスクを終了し、直後に**次のタスクを新たに開始**できるツール

🔁 コンテキストの引き継ぎが可能 → 事前定義された内容を新しいタスクに渡せる

🧠 例：要約、次のステップ、コードスニペットなど

---

## コンテキストの可視化と管理

🧠 Clineは現在のコンテキスト使用率（token数）を常に追跡  
📊 これをもとに、セッションの切り替えを提案

> 例：「使用率が70%を超えたので、新しいタスクを開始しましょうか？」

---

## /newtask スラッシュコマンド

- 自分から明示的にタスク分離したいときに使う
- `/newtask` と入力するだけでOK
- Clineが**現在の要点・次の作業内容**をまとめて提示
- 内容は確認・修正・承認できる

---

## new_taskの使いどころ

| 活用例                         | 内容                                                   |
|------------------------------|--------------------------------------------------------|
| 文脈が増えすぎてLLM性能が劣化してきた時 | context使用率に応じて切り替え（例：70%超）                  |
| サブタスクを分割して進めたい時         | Planモードで設計 → subtaskごとに分離                      |
| 会話の整理がつかなくなってきた時       | 会話と実装の整理を兼ねてセッションを再スタート              |
| boilerplateを自動挿入したい時         | 特定のテンプレートやルールを事前に読み込んだ状態で新規開始     |

---

## .clinerulesと組み合わせて自動化！

`new_task` × `.clinerules` により**戦略的なセッション制御が可能**になります：

- 使用率に応じた自動トリガー（例：>50%）
- モデルごとのtoken閾値に応じた分岐
- 処理単位（関数・テスト単位）での**ブレークポイント設定**

---

## .clinerulesによる引き継ぎ形式（例）

<br>

```plaintext
## Completed Work:
- 実装済み機能一覧
- 編集／作成したファイル
- 主要な設計決定

## Current State:
- 現在の進捗や重要ファイルの状態

## Next Steps:
- 優先順位付きのToDo

## References:
- 関連コード／リンク
- ユーザー設定／パターン
```

---

## 典型的なフロー（例）

1. Planモードで設計
2. Subtask Aの実装
3. context使用率 > 70%
4. 新しいタスク作成の提案
5. ユーザー確認
6. 承認、new_task起動
7. 次のタスクへ文脈を引き継ぎ

---

## .clinerules の例： タスクハンドオフ戦略ガイド

[Task Handoff Strategy Guide](https://docs.cline.bot/exploring-clines-tools/new-task-tool#example-.clinerules-task-handoff-strategy-guide)はコンテキストウィンドウ管理にnew_taskを使うことに特化した.clinerulesの例です。コピー＆ペーストで.clinerulesに追加できます。
